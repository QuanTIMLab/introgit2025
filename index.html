<!DOCTYPE html>
<html>
  <head>
  <title>Introduction √† Git</title>
    <meta charset="utf-8">
    <style>
  @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
  @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
  @import url(https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Fira Code','Ubuntu Mono','Consolas','Courier New',monospace; font-variant-ligatures: none; }
      pre, code, code.terminal, pre code, .file-view__body, .file-view__body code {
        font-family: 'Fira Code','Ubuntu Mono','Consolas','Courier New',monospace !important;
        font-size: 0.95em;
        line-height: 1.35;
        font-variant-ligatures: none;
      }
      /* Augmenter l'espace horizontal utile */
      .remark-slide-content { padding-left: 1.6em; padding-right: 1.6em; }
  /* Cadre d'affichage pour participants.md */
  .file-view { border: 1px solid #ccc; border-radius: 6px; background: #f8f8f8; }
  .file-view__title { font-family: 'Ubuntu Mono', monospace; font-size: 0.9em; background: #eee; padding: 6px 10px; border-bottom: 1px solid #ddd; }
  .file-view__body { margin: 0; padding: 10px; overflow: auto; max-height: 50vh; font-family: 'Ubuntu Mono', monospace; }
  /* Variante d'affichage pour la liste des participants (plus compacte) */
  .file-view--participants .file-view__body { font-size: 0.85em; line-height: 1.2; }
  /* Mise en page sp√©cifique du slide Exercice */
  .exercise-row { gap: 1rem; font-size: 0.82em; line-height: 1.3; }
  .exercise-row .col-left { flex: 0 0 calc(62% - 0.5rem); }
  .exercise-row .col-right { flex: 0 0 calc(38% - 0.5rem); }
    </style>
  </head>
  <body>
    <textarea id="source">
<!-- LTeX: language=fr -->
class: center, middle

# Introduction √† √† la gestion de version avec Git
### Pour d√©butant¬∑es
#### Par Oskar Laverny
Septembre 2025

[Repo de la s√©ance](https://GitHub.com/QuanTIMLab/introgit2025)

---


# Gestion de version ? 

<script>
  remark.macros.scale = function (percentage) {
  var url = this;
  return '<img src="' + url + '" style="width: ' + percentage + '" />';
};
</script>

<style>
  .row {
  display: flex;
}

.column {
  flex: 50%;
}
</style>

<div class="row">
  <div class="column">
    <img src="img/phdcomics.gif" alt="Piled Higher and Deeper by Jorge Cham. Source: www.phdcomics.com" style="width: 75%" />
  </div>
  <div class="column">    Les m√©thodes ¬´ primitives ¬ª (copie de dossiers, mails) sont manuelles et donc sources d‚Äôerreurs : <br /><br />
    1. On a besoin d‚Äôun historique de ce qui a √©t√© fait.<br /><br />
    2. Pouvoir revenir √† une version pr√©c√©dente (et comparer) est pr√©cieux.<br /><br />
    3. La collaboration doit √™tre fluide.<br /><br />
    ‚áí Il vous <em>faut</em> un syst√®me de gestion de versions (VCS). <br /><br /><br />
  
  </div>
</div>

---


# Pourquoi un syst√®me de contr√¥le de version ?

Un VCS (Version Control System) **suit les changements sur un ensemble de fichiers/dossiers** et facilite la collaboration.

Il enregistre une suite d‚Äô**instantan√©s (commits)** avec des **m√©tadonn√©es**.

Int√©r√™ts :
- Collaboration structur√©e
- Efficace pour petits comme grands projets
- R√©pond vite aux questions ¬´ qui / quand / pourquoi ? ¬ª
- **Permet de revenir √† n‚Äôimporte quel √©tat ant√©rieur**
- **G√©rer plusieurs versions en parall√®le (branches)**

**Remarque** : imprimer + annoter + rescanner = VCS primitif ; l‚Äôenvoi par mail fonctionne mais devient vite chaotique (fusion manuelle p√©nible).


---




## Contr√¥le de version & recherche reproductible

Dans le monde acad√©mique, on manipule beaucoup de fichiers texte :
- Articles en `.tex`, r√©f√©rences en `.bib` pour ceux qui √©crivent en latex.
- Donn√©es en `.csv` ou autre
- Code source (analyses, figures, tableaux)
- Pipeline de compilation (ex: `Makefile`)

La **reproductibilit√©** exige de pouvoir reconstruire les r√©sultats. <b>Un VCS facilite cela</b>

## Motivations classiques

- **Transparence** du travail, **Tra√ßabilit√©** fine des changements
- **Collaboration** fluide (√©vite la jungle des mails)
- **Automatisation** (g√©n√©ration, tests, rapports‚Ä¶)

Projet acad√©mique = Ensemble de modif sur des fichiers textes. ‚áí **Comme un projet logiciel !**

---

# Git : le standard de fait

<div class="row">
  <div class="column">
    <img src="img/git.png" alt="XKCD Comic" style="width: 70%" />
  </div>
  <div class="column"> 

  1. Cr√©√© en 2005 par Linus Torvalds pour le noyau Linux.<br /><br />
  2. <a href=https://insights.stackoverflow.com/survey/2021#overview>SODS2021</a> : ~94% des devs l‚Äôutilisent quotidiennement.<br /><br />
  3. GitHub h√©berge >200M d√©p√¥ts.<br /><br /><br />
  <b>Programme :</b><br /><br />
  I. Introduction <i>bottom-up</i> √† Git<br /><br />
  II. Exemples d‚Äôapplication √† la recherche<br /><br />
  III. Travaux pratiques
  </div>
</div>

---


class: center, middle

# I. Introduction <i>bottom-up</i> √† Git 

---

# Mod√®le de donn√©es de Git

Un **d√©p√¥t** est un ensemble de fichiers/dossiers dans un r√©pertoire racine.

```terminal
(root) (tree)
  |
  | - analysis (tree)
  |    |
  |    | - data.csv (blob)
  |    | - script.jl (blob)
  |
  | - bibliograpy.bib (blob)
  | - paper.tex (blob)
  | - makefile (blob)
  |
```

Vocabulaire: 

Les dossiers sont des **trees**, les fichiers des **blobs** (structure r√©cursive).

On parle de **snapshot** pour une capture √† un instant `t` du statut du r√©pertoire.

Un **commit** est un snapshot avec de la m√©tadata: auteur, comentaire, date, lien vers le(s) commit(s) pr√©c√©dent, etc.

---

# Mod√®le d‚Äôhistorique

Git mod√©lise l‚Äôhistorique comme un **DAG (graphe acyclique orient√©)**. Chaque commit pointe vers son (ou ses) parent(s).

Historique lin√©aire :

```terminal
o---o---o
```

Travaux parall√®les via branches :
```terminal
o---o---o---o (you add a missing proof)
             \
              o---o---o (your coauthor fixes a notation)
```

Les branches peuvent √™tre fusionn√©es :
```terminal
o---o---o---o-----------o (both the proof and the notation fix are included)
             \         /
              o---o---o
```

---

# Pseudo‚Äëimpl√©mentation (sch√©matique)

On peut mod√©liser (grossi√®rement) la logique interne. 

Un fichier = suite d‚Äôoctets :
```julia
Blob = Vector{Byte}
```
Un dossier contient des entr√©es nomm√©es :
```julia
Tree = Dict{String,Union{Tree,Blob}}
```
Un commit : parents + m√©tadonn√©es + arbre racine :
```julia
struct Commit
    parent::Vector{Commit} # might be empty 
    author::String
    message::String
    snapshot::Tree
end
```

---

# Objets & adressage par contenu

Un **objet** = blob, tree ou commit.

```julia
Object = Union{Blob,Tree,Commit}
```

Adressage par le contenu (hash) : stockage d‚Äôobjets index√©s par identifiant :

```julia
# le "store" principal:
objects = Dict{String, Object}() # on l'initialise vide.  
```

Les clefs = hash SHA‚Äë1 de chaque objet :

```julia
function store!(objects, o)
    id = sha1(o)
    objects[id] = o
end

function load(objects, id)
    return objects[id]
end
```

*Note : r√©f√©rences => pas de duplications inutiles.*

---

## Exemple de hash SHA‚Äë1

Un hash SHA‚Äë1 : cha√Æne hexad√©cimale de 40 caract√®res.

- D√©terministe mais sensible √† tout changement (cahotique)
- Sert d‚Äôidentifiant de contenu
- **Probl√®me : peu lisible** 

Git g√®re aussi une liste de r√©f√©rence lisibles:
```julia
references = Dict{String,String}() # mappe des noms lisibles √† des hash sha-1. 
```

Ex : `corrige_preuve`, `main`, `HEAD`, `v0.1`, `soumission` ‚Ä¶

On r√©f√©rence ainsi les objets par leur nom.

**Remarque** : le graphe est immutable, mais les r√©f√©rences sont bien mutables.
---

# Quelques commandes

Les commandes modifient soit l‚Äôhistorique (nouveaux commits), soit les r√©f√©rences :

```terminal 
git commit
git checkout
git branch
git merge
```

```terminal
---------------------------------------------------
o---o---o (HEAD -> master)
--------------------------------------------------- git commit
o---o---o---o (HEAD -> master)
--------------------------------------------------- git branch; git checkout; git commit x2
o---o---o---o (master)
             \          
              o---o---o (HEAD -> bugfix)
--------------------------------------------------- git checkout; git merge
o---o---o---o-----------o (HEAD -> master)
             \         /
              o---o---o (bugfix)
---------------------------------------------------
```

---



class: center, middle

class: center, middle

# II. Exemples d‚Äôapplication √† la recherche

---


# Probl√®me de ¬´ templating ¬ª (1/3)

On a termin√© une version d‚Äôun article :
```terminal 
lrnv@laptop paper $ git log --oneline --graph
* <span style="color:yellow;">b9f1617</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:aqua;">HEAD -&gt; </span><span style="font-weight:bold;color:lime;">master</span><span style="color:yellow;">, </span><span style="font-weight:bold;color:yellow;">tag: v1.0</span><span style="color:yellow;">)</span> Fix a typo <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">3 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">3cb7e6c</span> Add proof of main Thm <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">4 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">88d916e</span> Add definition of XX <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">4 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">147a080</span> First commit <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">5 minutes ago (2023-01-12)</span>
```

La version courante tagg√©e `v1.0` est envoy√©e √† l‚Äôarchive / revue. On doit g√©n√©rer une variante conforme aux exigences de la revue (gabarit, notations). **On cr√©e une branche :**

```terminal 
lrnv@laptop paper $ git checkout -b templating
Switched to a new branch 'templating'
```

On adapte sur la branche d√©di√©e et on commit les modifications.
---
# Probl√®me de ¬´ templating ¬ª (2/3)

```terminal 
lrnv@laptop paper $ git log --oneline --graph
* <span style="color:yellow;">d380354</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:aqua;">HEAD -&gt; </span><span style="font-weight:bold;color:lime;">templating</span><span style="color:yellow;">)</span> Comply with journal's XX template <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">18 seconds ago (2023-01-12)</span>
* <span style="color:yellow;">b9f1617</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:yellow;">tag: v1.0</span><span style="color:yellow;">, </span><span style="font-weight:bold;color:lime;">master</span><span style="color:yellow;">)</span> Fix a typo <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">8 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">3cb7e6c</span> Add proof of main Thm <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">8 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">88d916e</span> Add definition of XX <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">9 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">147a080</span> First commit <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">10 minutes ago (2023-01-12)</span>
```

On envoie la branche `templating`. Pendant la r√©vision on d√©couvre une erreur ‚Üí on corrige sur `master`.

```terminal 
lrnv@laptop paper $ git log --oneline --graph
* <span style="color:yellow;">fde936d</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:aqua;">HEAD -&gt; </span><span style="font-weight:bold;color:lime;">master</span><span style="color:yellow;">)</span> Fix error about XXX <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">23 seconds ago (2023-01-12)</span>
<span style="color:red;">|</span> * <span style="color:yellow;">d380354</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:lime;">templating</span><span style="color:yellow;">)</span> Comply with journal's XX template <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">4 minutes ago (2023-01-12)</span>
<span style="color:red;">|</span><span style="color:red;">/</span>  
* <span style="color:yellow;">b9f1617</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:yellow;">tag: v1.0</span><span style="color:yellow;">)</span> Fix a typo <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">11 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">3cb7e6c</span> Add proof of main Thm <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">12 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">88d916e</span> Add definition of XX <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">12 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">147a080</span> First commit <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">13 minutes ago (2023-01-12)</span>
```

---

# Probl√®me de ¬´ templating ¬ª (3/3)

```terminal 
lrnv@laptop paper $ git checkout templating && git merge master && git log --oneline --graph
* <span style="color:yellow;">b9faeb0</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:aqua;">HEAD -&gt; </span><span style="font-weight:bold;color:lime;">templating</span><span style="color:yellow;">)</span> Merge commit  <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">1 seconds ago (2023-01-12)</span>
<span style="color:red;">|</span><span style="color:green;">\</span>  
* <span style="color:green;">|</span> <span style="color:yellow;">fde936d</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:aqua;">HEAD -&gt; </span><span style="font-weight:bold;color:lime;">master</span><span style="color:yellow;">)</span> Fix error about XXX <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">23 seconds ago (2023-01-12)</span>
<span style="color:red;">|</span> * <span style="color:yellow;">d380354</span> Comply with journal's XX template <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">4 minutes ago (2023-01-12)</span>
<span style="color:red;">|</span><span style="color:green;">/</span>  
* <span style="color:yellow;">b9f1617</span><span style="color:yellow;"> (</span><span style="font-weight:bold;color:yellow;">tag: v1.0</span><span style="color:yellow;">)</span> Fix a typo <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">11 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">3cb7e6c</span> Add proof of main Thm <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">12 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">88d916e</span> Add definition of XX <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">12 minutes ago (2023-01-12)</span>
* <span style="color:yellow;">147a080</span> First commit <span style="font-weight:bold;color:#3333FF;">Oskar Laverny </span><span style="color:lime;">13 minutes ago (2023-01-12)</span>



```

Les deux variantes contiennent maintenant la correction. M√™me logique avec plus de branches.

**Rappel** : objets immuables, r√©f√©rences d√©plac√©es.
---
# GitHub, GitHub Actions, latexdiff.  
<div class="row">
  <div class="column">

    GitHub h√©berge des d√©p√¥ts et centralise la collaboration. <br />
    
    Les <a href="https://GitHub.com/features/actions">GitHub Actions</a> automatisent l'execution de code (analyse, tests, compilation, etc.) √† chaque commit. Exemples: <ul>
      <li>Tests / int√©gration continue</li>
      <li><b>Compilation automatique d'un pdf</b> </li>
      <li>URL fixe pour les artefacts</li>
    </ul>

    Int√©gration continue => reproductibilit√© continue. <br/><br/>Automatiser r√©duit les risques d'oublis et le potentiel d'erreurs manuelles.. 
  </div>
  <div class="column"> 

    L‚Äôoutil <a href="https://gitlab.com/git-latexdiff/git-latexdiff">git-latexdiff</a> g√©n√®re un PDF comparatif (ajouts/suppressions) entre deux versions LaTeX.<br /><br />

    D√©clench√© √† chaque commit => suivi fin.<br /><br />

    <img src="img/diff.png" alt="Diff LaTeX" style="width: 100%" />

    Id√©al pour les revues.
  </div>
</div>


---




# Collaboration: Issues & Pull Requests

**Quand on a plusieurs auteurs** : un d√©p√¥t central + discussions publiques.

- Issues : **proposer / discuter** des changements, lier aux commits
- Pull Requests : **relire / valider** avant fusion

Collaboration √©crite asynchrone = tra√ßabilit√© et ratrappages facilit√©s.

**Exemple : <a href="https://GitHub.com/HoTT/book">HoTT textbook on informal homotopy type theory</a>**
- ~ 600 pages
- 20+ contributeurs
- 1000+ issues & PRs
- termin√© en 6 mois.

Voir le billet d‚ÄôAndrej Bauer (<a href="https://math.andrej.com/2013/06/20/the-hott-book/">lien</a>) pour l'histoire.

---

### Exp√©rimenter sans risque

**Cr√©er une branche** = espace d‚Äôessai sans casser le reste. **Pas de risque ‚áí innovation √† faible co√ªt.**

### Exemple de g√©n√©ration automatique

Voir [mon CV](https://github.com/lrnv/cv): modif ‚Üí commit ‚Üí build auto ‚Üí nouveau `cv.pdf` √† URL stable.

Lien stable = toujours la derni√®re version.

### GitHub Pages

H√©bergement gratuit de sites statiques (docs, blog, d√©mos) directement depuis le d√©p√¥t.
Id√©al pour partager jeux de donn√©es / r√©sultats enrichis.

### JOSS: The Journal of open-source software

<a href="https://joss.theoj.org/">JOSS</a> : journal qui **√©value et publie du code** (DOI, citation).
---

class: center, middle

# Travaux pratiques

---

# Pas de compte GitHub ? (setup en 5 min)

- Cr√©ez un compte sur https://github.com (avec un email auquel vous avez acc√®s).
- Dites‚Äële moi: je vous ajoute √† l‚Äôorganisation QuanTIMLab (droits d‚Äô√©criture).
- Configurez Git sur votre machine:
```terminal
git config --global user.name "Pr√©nom Nom"
git config --global user.email "votre.email@exemple.com"  # id√©alement le m√™me que celui de GitHub
git config --global core.autocrlf true # Windows uniquement
```
- Authentification HTTPS (recommand√©):
  - Au premier `git push`, une fen√™tre Git Credential Manager s‚Äôouvre ‚Üí ¬´ Sign in with your browser ¬ª ‚Üí validez.
  - Si un ¬´ Personal Access Token ¬ª est demand√©, choisissez la connexion via navigateur.
- Test rapide:
```terminal
git ls-remote https://GitHub.com/QuanTIMLab/introgit2025.git
```

Doit d√©clencher la connexion si n√©cessaire puis lister les r√©f√©rences distantes.

---
# Exercice : Remplir la fiche de pr√©sence.
### https://github.com/quantimlab/introgit2025.git

<div class="row exercise-row">
  <div class="column col-left">
    <p>Session Windows FEG + Ouvrir "Terminal" (poweshell) puis clonez: </p>
    <pre><code class="terminal">git clone URL
cd introgit2025</code></pre>

    <p>Ajouter votre pr√©nom √† la fin de <code>participants.md</code>, validez et poussez:</p>
    <pre><code class="terminal">git status
git add participants.md
git commit -m "Ajoute Pr√©nom au fichier des participants"
git pull --rebase origin main # astuce anti-conflits
git push origin main</code></pre>

    <p><strong>D√©pannage <code>git push</code></strong>: Si le push √©choue (403/droits), v√©rifiez que vous √™tes bien <b>membre de l‚Äôorganisation QuanTIMLab</b> et <b>correctement connect√©</b>. V√©rifiez aussi l‚ÄôURL du remote:
      <pre><code class="terminal">git remote -v</code></pre> doit pointer vers <code>https://github.com/QuanTIMLab/introgit2025.git</code></p>
  </div>
  <div class="column col-right">
    <h3>Fiche de pr√©sence (live)</h3>
    <div id="participants-live">Chargement en cours‚Ä¶</div>
    <small>Mise √† jour auto toutes les 15s ‚Äî source: <code>participants.md</code> (branche main)</small>
  </div>
</div>


---


class: center, middle

# Activit√© bonus (si temps/r√©seau):
## Faire une Pull Request qui modifie ces slides ‚ú®

√âtapes: Cr√©er une branche ‚Üí modifier une slide ‚Üí `add` ‚Üí `commit` ‚Üí `push` ‚Üí ouvrir une PR.

---

class: center, middle

# Merci üôå

En plus des consignes, le repo contient une fiche m√©mo, avec des liens vers des ressources int√©ressantes si vous souhaitez vous y metre :)

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script type="text/javascript">
        var hljs = remark.highlighter.engine;
    </script>
    <script type="text/javascript">
    /*
      Language: terminal console
      Author: Josh Bode <joshbode@gmail.com>
      See https://joshbode.GitHub.io/remark/ansi.html#5
      And also https://GitHub.com/theZiz/aha
    */
    hljs.registerLanguage('terminal', function() {
        return {
          contains: [
            { className: 'string', begin: '^([\\w.]+)@([\\w.]+)' },
            { className: 'constant', begin: ' (.*) \\\\$ ' },
            { className: 'ansi', begin: '<span style\\=\"([^\"]+)\">', end: '<\\/span>' }
          ]
        }
      });
    </script>
    <script type="text/javascript">
      var slideshow = remark.create({
        highlightStyle: 'monokai',
        ratio: '16:10'
      });
      // extract the embedded styling from ansi spans
      var highlighted = document.querySelectorAll("code.terminal span.hljs-ansi");
      Array.prototype.forEach.call(highlighted, function(next) {
          next.insertAdjacentHTML("beforebegin", next.textContent);
          next.parentNode.removeChild(next);
      });
      // Live participants fetcher
      (function(){
        const RAW_URL = 'https://raw.GitHubusercontent.com/QuanTIMLab/introgit2025/main/participants.md';
        const API_URL = 'https://api.GitHub.com/repos/QuanTIMLab/introgit2025/contents/participants.md?ref=main';
        const TARGET_ID = 'participants-live';

        function escapeHtml(s){
          return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
        }

        function render(text){
          const el = document.getElementById(TARGET_ID);
          if (!el) return;
          const content = escapeHtml(text || '');
          el.innerHTML =
            '<div class="file-view file-view--participants">' +
              '<div class="file-view__title">participants.md</div>' +
              '<pre class="file-view__body"><code>' + content + '</code></pre>' +
            '</div>';
        }

        async function fetchRaw(){
          const url = RAW_URL + '?ts=' + Date.now(); // anti-cache CDN
          const resp = await fetch(url, { cache: 'no-store' });
          if (!resp.ok) throw new Error('raw fetch failed');
          return await resp.text();
        }

        async function fetchApi(){
          const url = API_URL + '&ts=' + Date.now(); // anti-cache √©ventuel
          const resp = await fetch(url, {
            cache: 'no-store',
            headers: { 'Accept': 'application/vnd.GitHub.v3+json' }
          });
          if (!resp.ok) throw new Error('api fetch failed');
          const json = await resp.json();
          const b64 = (json && json.content) ? json.content.replace(/\s/g,'') : '';
          const text = atob(b64);
          return text;
        }

        async function update(){
          try{
            const txt = await fetchApi();
            render(txt);
          }catch(err){
            try{
              const txt = await fetchRaw();
              render(txt);
            }catch(err2){
              const el = document.getElementById(TARGET_ID);
              if (el) el.textContent = 'Impossible de charger participants.md';
            }
          }
        }

        update();
        setInterval(update, 15000);
        // Rafra√Æchir imm√©diatement quand on change de slide (utile quand on arrive sur l'exercice)
        if (slideshow && typeof slideshow.on === 'function') {
          try {
            slideshow.on('showSlide', update);
            slideshow.on('afterShowSlide', update);
          } catch (e) { /* no-op */ }
        }
      })();
    </script>
  </body>
</html>
